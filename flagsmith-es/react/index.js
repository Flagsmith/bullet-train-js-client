import t,{createContext as r,useEffect as e,useContext as n,useState as o,useRef as a,useCallback as i,useMemo as u}from"react";var c=function(){return c=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},c.apply(this,arguments)};var f=new function t(){for(var r={},e=this,n=0;n<arguments.length;n++){var o=arguments[n];switch(typeof o){case"string":r[o]=[];break;case"object":e=o;break;default:throw new TypeError("Eventjs() only accepts string and object parameters")}}if(e===this&&!(this instanceof t))throw new ReferenceError('Eventjs is not called with "new" keyword and no parameter of type object is passed to it');function a(t){if("string"!=typeof t||!r[t])throw new ReferenceError("The event name does not exist in this event manager: "+t);return!0}return e.on=function(t){a(t);for(var e=1;e<arguments.length;e++){var n=arguments[e];-1===r[t].indexOf(n)&&r[t].push(n)}return this},e.off=function(t){switch(arguments.length){case 0:for(var n in r)r.hasOwnProperty(n)&&e.off(n);break;case 1:a(t),r[t].length=0;break;default:a(t);for(var o=1;o<arguments.length;o++){var i=arguments[o],u=r[t].indexOf(i);-1!==u&&r[t].splice(u,1)}}return this},e.trigger=function(t){a(t);for(var n=[],o=1;o<arguments.length;o++)n.push(arguments[o]);for(var i=r[t],u=[],c=0;c<i.length;c++){var f=i[c];try{f.apply(e,n)}catch(t){u.push({listener:f,error:t})}}if(u.length>0)throw u;return this},e}("event"),s=r(null),h=function(r){var n=r.flagsmith,o=r.options,a=r.serverState,i=r.children;return a&&!n.initialised&&n.setState(a),e((function(){o?n.init(c(c({},o),{onChange:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];o.onChange&&o.onChange.apply(o,t),f.trigger("event")}})):n.trigger=function(){return f.trigger("event")}}),[]),t.createElement(s.Provider,{value:n},i)},l=function(t){var r=a(t);return r.current||(r.current=t),r.current},g=function(t){if("string"==typeof t)return[t];if("object"==typeof t&&t.hasOwnProperty("length"))return t;throw new Error("Flagsmith: please supply an array of strings or a single string of flag keys to useFlags")},v=function(t,r,e){return void 0===e&&(e=[]),r.map((function(r){return"".concat(t.getValue(r)).concat(t.hasFeature(r))})).concat(e.map((function(r){return"".concat(t.getTrait(r))}))).join(",")};function p(t,r){void 0===r&&(r=[]);var c=l(g(t)),h=l(g(r)),p=n(s),w=o(v(p,c)),d=w[0],y=w[1],m=a(d),b=i((function(){var t=v(p,c,h);t!==m.current&&(m.current=t,y(t))}),[]);return e((function(){return f.on("event",b),function(){f.off("event",b)}}),[]),u((function(){var t={};return c.map((function(r){t[r]={enabled:p.hasFeature(r),value:p.getValue(r)}})).concat(null==h?void 0:h.map((function(r){t[r]=p.getTrait(r)}))),t}),[d])}var w=function(){var t=n(s);if(!t)throw new Error("useFlagsmith must be used with in a FlagsmithProvider");return t};export{s as FlagsmithContext,h as FlagsmithProvider,p as useFlags,w as useFlagsmith};
//# sourceMappingURL=index.js.map
