!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["flagsmith/react"]={},t.React)}(this,(function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(e),i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)},o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.reduce((function(t,e){return"object"==typeof e&&Object.keys(e).forEach((function(n){t[n]=e[n]})),t}),{});return n},a=function(){function t(){this.____callbacks=[],this.____callbacks=[]}return t.prototype.on=function(t,e,n){var r=this;void 0===n&&(n=!1);var i=t.split(" ");if(i.length>1)i.forEach((function(t){r.on(t,e,n)}));else{void 0===this.____callbacks[t]&&(this.____callbacks[t]=[]);var o=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if("function"==typeof e){e.apply(this,n);var i=this.____callbacks[t].indexOf(o);i>-1&&this.____callbacks[t].splice(i,1)}};this.____callbacks[t].push(n?o:e)}return this},t.prototype.one=function(t,e){this.on(t,e,!0)},t.prototype.off=function(t,e){var n=this,r=t.split(" ");if(r.length>1)r.forEach((function(t){n.off(t,e)}));else if(void 0!==this.____callbacks[t])if(void 0!==e){var i=this.____callbacks[t].indexOf(e);i>-1&&this.____callbacks[t].splice(i,1)}else this.____callbacks[t]=[];return this},t.prototype.trigger=function(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(n.length>0){var i;if("object"==typeof n[0]){var o=n[0].type,a=n[0];n[0]instanceof Array&&(o=n[0][0],a=n[0][1]),(i=t.CustomEvent(o,{bubbles:!1,cancelable:!1})).originalEvent=a}else(i=t.CustomEvent(n[0],{bubbles:!1,cancelable:!1})).originalEvent=null;void 0!==this.____callbacks[i.type]&&(n.shift(),n.unshift(i),this.____callbacks[i.type].forEach((function(t){t.apply(e,n)})))}return this},t.CustomEvent=function(t,e){if(void 0===e&&(e={}),e=o({bubbles:!1,cancelable:!1,detail:void 0},e),"undefined"!=typeof window){if("function"==typeof window.CustomEvent)return new window.CustomEvent(t,e);var n=function(e,n){void 0===n&&(n={});var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),r};return n.prototype=window.Event.prototype,n(0,e)}return o({type:t,originalEvent:null},e)},t}(),u=new a,c=e.createContext(null),s=function(t){var n=e.useRef(t);return n.current||(n.current=t),n.current},l=function(t){if("string"==typeof t)return[t];if("object"==typeof t&&t.hasOwnProperty("length"))return t;throw new Error("Flagsmith: please supply an array of strings or a single string of flag keys to useFlags")},f=function(t,e,n){return void 0===n&&(n=[]),e.map((function(e){return"".concat(t.getValue(e)).concat(t.hasFeature(e))})).concat(n.map((function(e){return"".concat(t.getTrait(e))}))).join(",")};t.FlagsmithContext=c,t.FlagsmithProvider=function(t){var n=t.flagsmith,o=t.options,a=t.serverState,s=t.children,l=e.useRef(!0);return a&&!n.initialised&&n.setState(a),l.current&&(l.current=!1,o?n.init(i(i({},o),{onChange:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.onChange&&o.onChange.apply(o,t),u.trigger("event")}})):n.trigger=function(){return u.trigger("event")}),r.default.createElement(c.Provider,{value:n},s)},t.useFlags=function(t,n){void 0===n&&(n=[]);var r=s(l(t)),i=s(l(n)),o=e.useContext(c),a=e.useState(f(o,r)),h=a[0],v=a[1],p=e.useRef(h),_=e.useCallback((function(){var t=f(o,r,i);t!==p.current&&(p.current=t,v(t))}),[]);return e.useEffect((function(){return u.on("event",_),function(){u.off("event",_)}}),[]),e.useMemo((function(){var t={};return r.map((function(e){t[e]={enabled:o.hasFeature(e),value:o.getValue(e)}})).concat(null==i?void 0:i.map((function(e){t[e]=o.getTrait(e)}))),t}),[h])},t.useFlagsmith=function(){var t=e.useContext(c);if(!t)throw new Error("useFlagsmith must be used with in a FlagsmithProvider");return t},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
