!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["flagsmith/react"]={},e.React)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(t),o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)};var a=new function e(){for(var t={},n=this,r=0;r<arguments.length;r++){var o=arguments[r];switch(typeof o){case"string":t[o]=[];break;case"object":n=o;break;default:throw new TypeError("Eventjs() only accepts string and object parameters")}}if(n===this&&!(this instanceof e))throw new ReferenceError('Eventjs is not called with "new" keyword and no parameter of type object is passed to it');function a(e){if("string"!=typeof e||!t[e])throw new ReferenceError("The event name does not exist in this event manager: "+e);return!0}return n.on=function(e){a(e);for(var n=1;n<arguments.length;n++){var r=arguments[n];-1===t[e].indexOf(r)&&t[e].push(r)}return this},n.off=function(e){switch(arguments.length){case 0:for(var r in t)t.hasOwnProperty(r)&&n.off(r);break;case 1:a(e),t[e].length=0;break;default:a(e);for(var o=1;o<arguments.length;o++){var i=arguments[o],u=t[e].indexOf(i);-1!==u&&t[e].splice(u,1)}}return this},n.trigger=function(e){a(e);for(var r=[],o=1;o<arguments.length;o++)r.push(arguments[o]);for(var i=t[e],u=[],f=0;f<i.length;f++){var s=i[f];try{s.apply(n,r)}catch(e){u.push({listener:s,error:e})}}if(u.length>0)throw u;return this},n}("event"),i=t.createContext(null),u=function(e){var n=t.useRef(e);return n.current||(n.current=e),n.current},f=function(e){if("string"==typeof e)return[e];if("object"==typeof e&&e.hasOwnProperty("length"))return e;throw new Error("Flagsmith: please supply an array of strings or a single string of flag keys to useFlags")},s=function(e,t,n){return void 0===n&&(n=[]),t.map((function(t){return"".concat(e.getValue(t)).concat(e.hasFeature(t))})).concat(n.map((function(t){return"".concat(e.getTrait(t))}))).join(",")};e.FlagsmithContext=i,e.FlagsmithProvider=function(e){var n=e.flagsmith,u=e.options,f=e.serverState,s=e.children;return f&&!n.api&&n.setState(f),t.useEffect((function(){n.init(o(o({},u),{onChange:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];u.onChange&&u.onChange.apply(u,e),a.trigger("event")}}))}),[]),r.default.createElement(i.Provider,{value:n},s)},e.useFlags=function(e,n){var r=u(f(e)),o=u(f(n)),c=t.useContext(i),l=t.useState(s(c,r)),h=l[0],g=l[1],p=t.useRef(h),v=t.useCallback((function(){var e=s(c,r,o);e!==p.current&&(p.current=e,g(e))}),[]);return t.useEffect((function(){return a.on("event",v),function(){a.off("event",v)}}),[]),t.useMemo((function(){var e={};return r.map((function(t){e[t]={enabled:c.hasFeature(t),value:c.getValue(t)}})).concat(null==o?void 0:o.map((function(t){e[t]=c.getTrait(t)}))),e}),[h])},e.useFlagsmith=function(){var e=t.useContext(i);if(!e)throw new Error("useFlagsmith must be used with in a FlagsmithProvider");return e},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
