!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.flagsmith=e():t.flagsmith=e()}(global,(function(){return(()=>{"use strict";var t={63:t=>{t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var i,a,r;if(Array.isArray(e)){if((i=e.length)!=n.length)return!1;for(a=i;0!=a--;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((i=(r=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(a=i;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,r[a]))return!1;for(a=i;0!=a--;){var s=r[a];if(!t(e[s],n[s]))return!1}return!0}return e!=e&&n!=n}},142:function(t,e,n){var i,a,r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},r.apply(this,arguments)},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i,a=0,r=e.length;a<r;a++)!i&&a in e||(i||(i=Array.prototype.slice.call(e,0,a)),i[a]=e[a]);return t.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0});var l="BULLET_TRAIN_DB",o="BULLET_TRAIN_EVENT",u="https://api.flagsmith.com/api/v1/",g=n(63),c=function(t){return"Attempted to "+t+" a user before calling flagsmith.init. Call flagsmith.init first, if you wish to prevent it sending a request for flags, call init with preventFetch:true."},f=function(){function t(t){var e=this;this.getJSON=function(t,n,a){var r=e,s=r.environmentID,l=r.headers,o={method:n||"GET",body:a,headers:{"x-environment-key":s}};return n&&"GET"!==n&&(o.headers["Content-Type"]="application/json; charset=utf-8"),l&&Object.assign(o.headers,l),i(t,o).then((function(t){return t.text().then((function(e){var n=e;try{n=JSON.parse(e)}catch(t){}return t.ok?n:Promise.reject(n)}))}))},this.getFlags=function(t,n){var i=e,a=i.onChange,s=i.onError,l=i.identity,o=i.api,u=!1,c=function(t,n){var i=t.flags,s=t.traits;e.withTraits=!1;var l={},o={};if(s=s||[],(i=i||[]).forEach((function(t){l[t.feature.name.toLowerCase().replace(/ /g,"_")]={id:t.feature.id,enabled:t.enabled,value:t.feature_state_value}})),s.forEach((function(t){o[t.trait_key.toLowerCase().replace(/ /g,"_")]=t.trait_value})),e.oldFlags=r({},e.flags),n){var u={};n.map((function(t){u[t.name]=t})),e.segments=u}var c=g(e.flags,l),f=g(e.traits,o);e.flags=l,e.traits=o,e.updateStorage(),a&&a(e.oldFlags,{isFromServer:!0,flagsChanged:!c,traitsChanged:!f})};return l?Promise.all([e.withTraits?e.getJSON(o+"identities/","POST",JSON.stringify({identifier:l,traits:Object.keys(e.withTraits).map((function(t){return{trait_key:t,trait_value:e.withTraits[t]}}))})):e.getJSON(o+"identities/?identifier="+encodeURIComponent(l))]).then((function(e){c(e[0],e[1]),t&&!u&&(u=!0,t())})).catch((function(t){var e=t.message;s&&s({message:e})})):Promise.all([e.getJSON(o+"flags/")]).then((function(e){c({flags:e[0]},null),t&&!u&&(u=!0,t())})).catch((function(t){n&&!u&&(u=!0,n(t)),s&&s(t)}))},this.analyticsFlags=function(){var t=e.api;if(0!==Object.getOwnPropertyNames(e.evaluationEvent).length)return e.getJSON(t+"analytics/flags/","POST",JSON.stringify(e.evaluationEvent)).then((function(t){var n=e.getState();e.setState(r(r({},n),{evaluationEvent:{}})),e.updateEventStorage()})).catch((function(t){e.log("Exception fetching evaluationEvent",t)}))},this.analyticsInterval=null,this.api=null,this.cacheFlags=null,this.enableAnalytics=null,this.enableLogs=null,this.environmentID=null,this.evaluationEvent=null,this.flags=null,this.getFlagInterval=null,this.headers=null,this.initialised=null,this.oldFlags=null,this.onChange=null,this.onError=null,this.identity=null,this.segments=null,this.ticks=null,this.timer=null,this.traits=null,this.withTraits=null,this.evaluateFlag=function(t){if(e.enableAnalytics){if(!e.evaluationEvent)return;void 0===e.evaluationEvent[t]&&(e.evaluationEvent[t]=0),e.evaluationEvent[t]+=1}e.updateEventStorage()},this.getValue=function(t){var n=e.flags&&e.flags[t.toLowerCase().replace(/ /g,"_")],i=null;return n&&(i=n.value),e.evaluateFlag(t),i},this.getTrait=function(t){return e.traits&&e.traits[t.toLowerCase().replace(/ /g,"_")]},this.setTrait=function(t,n){var i=e,a=i.getJSON,r=i.identity,s=i.api;if(s){var l={identity:{identifier:r},trait_key:t,trait_value:n};return a("".concat(s,"traits/"),"POST",JSON.stringify(l)).then((function(){e.initialised&&e.getFlags()}))}console.error(c("setTrait"))},this.setTraits=function(t){var n=e,i=n.getJSON,a=n.identity,r=n.api;if(r){t&&"object"==typeof t||console.error("Expected object for flagsmith.setTraits");var s=Object.keys(t).map((function(e){return{identity:{identifier:a},trait_key:e,trait_value:t[e]}}));return i("".concat(r,"traits/bulk/"),"PUT",JSON.stringify(s)).then((function(){e.initialised&&e.getFlags()}))}console.error(c("setTraits"))},this.incrementTrait=function(t,n){var i=e,a=i.getJSON,r=i.identity,s=i.api;return a("".concat(s,"traits/increment-value/"),"POST",JSON.stringify({trait_key:t,increment_by:n,identifier:r})).then(e.getFlags)},this.hasFeature=function(t){var n=e.flags&&e.flags[t.toLowerCase().replace(/ /g,"_")],i=!1;return n&&n.enabled&&(i=!0),e.evaluateFlag(t),i},i=t.fetch?t.fetch:global.fetch,a=t.AsyncStorage}return t.prototype.init=function(t){var e=this,n=t.environmentID,i=t.api,s=void 0===i?u:i,g=t.headers,c=t.onChange,f=t.cacheFlags,h=t.onError,v=t.defaultFlags,p=t.preventFetch,y=t.enableLogs,d=t.enableAnalytics,m=t.AsyncStorage,S=t.state;return new Promise((function(t,i){if(e.environmentID=n,e.api=s,e.headers=g,e.getFlagInterval=null,e.analyticsInterval=null,e.onChange=c,e.onError=h,e.enableLogs=y,e.enableAnalytics=d||!1,e.flags=Object.assign({},v)||{},e.initialised=!0,e.ticks=1e4,e.timer=e.enableLogs?(new Date).valueOf():null,m&&(a=m),e.cacheFlags=void 0!==a&&f,e.setState(S),!n)throw i("Please specify a environment id"),"Please specify a environment id";a.getItem(o).then((function(t){if(t)try{e.evaluationEvent=JSON.parse(t)}catch(t){e.evaluationEvent={}}else e.evaluationEvent={};e.analyticsInterval=setInterval(e.analyticsFlags,e.ticks)})),e.enableAnalytics&&(e.analyticsInterval&&clearInterval(e.analyticsInterval),a.getItem(o,(function(t,n){if(n){var i=JSON.parse(n);i&&(S=e.getState(),e.log("Retrieved events from cache",n),e.setState(r(r({},S),{evaluationEvent:i})))}}))),f?a.getItem(l,(function(n,a){if(a)try{var r=JSON.parse(a);r&&r.api===e.api&&r.environmentID===e.environmentID&&(e.setState(r),e.log("Retrieved flags from cache",r)),e.flags?(e.onChange&&e.onChange(null,{isFromServer:!1}),e.oldFlags=e.flags,t(!0),p||e.getFlags()):p?t(!0):e.getFlags(t,i)}catch(t){e.log("Exception fetching cached logs",t)}else p?(v&&e.onChange(null,{isFromServer:!1}),t(!0)):e.getFlags(t,i)})):p?(v&&e.onChange(null,{isFromServer:!1}),t(!0)):e.getFlags(t,i)})).catch((function(t){return h&&h(t)}))},t.prototype.getAllFlags=function(){return this.flags},t.prototype.identify=function(t,e){return this.identity=t,e&&(this.withTraits=e),this.initialised&&!this.getFlagInterval?this.getFlags():Promise.resolve()},t.prototype.getState=function(){return{api:this.api,environmentID:this.environmentID,flags:this.flags,identity:this.identity,segments:this.segments,traits:this.traits,evaluationEvent:this.evaluationEvent}},t.prototype.setState=function(t){t&&(this.initialised=!0,this.api=t.api||this.api||u,this.environmentID=t.environmentID||this.environmentID,this.flags=t.flags||this.flags,this.identity=t.identity||this.identity,this.segments=t.segments||this.segments,this.traits=t.traits||this.traits,this.evaluationEvent=t.evaluationEvent||this.evaluationEvent)},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enableLogs&&console.log.apply(this,s(["FLAGSMITH:",(new Date).valueOf()-this.timer,"ms"],t,!0))},t.prototype.updateStorage=function(){if(this.cacheFlags){var t=JSON.stringify(this.getState());this.log("Setting storage",t),a.setItem(l,t)}},t.prototype.updateEventStorage=function(){if(this.enableAnalytics){var t=JSON.stringify(this.getState().evaluationEvent);this.log("Setting event storage",t),a.setItem(o,t)}},t.prototype.logout=function(){return this.identity=null,this.segments=null,this.traits=null,this.initialised&&!this.getFlagInterval?this.getFlags():Promise.resolve()},t.prototype.startListening=function(t){void 0===t&&(t=1e3),this.getFlagInterval&&clearInterval(this.getFlagInterval),this.getFlagInterval=setInterval(this.getFlags,t)},t.prototype.stopListening=function(){clearInterval(this.getFlagInterval),this.getFlagInterval=null},t.prototype.getSegments=function(){},t}();e.default=function(t){var e=t.fetch,n=t.AsyncStorage;return new f({fetch:e,AsyncStorage:n})}}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}var i={};return(()=>{var t=i;Object.defineProperty(t,"__esModule",{value:!0}),t.createFlagsmithInstance=void 0;var e=n(142);t.default=(0,e.default)({}),t.createFlagsmithInstance=function(){return(0,e.default)({})}})(),i})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixpQkFFdkI0QixLQUFLNUIsZ0JBQWtCd0IsWUFBWUksS0FBS2hGLFNBQVVzRCxJQUd0RCxZQUFBbUMsY0FBQSxXQUNJWixjQUFjRyxLQUFLNUIsaUJBQ25CNEIsS0FBSzVCLGdCQUFrQixNQUczQixZQUFBc0MsWUFBQSxhQWdISixFQXplZSxHQTZlZixtQkFBeUIsRyxJQUFFckIsRUFBSyxRQUFFaEcsRUFBWSxlQUMxQyxPQUFPLElBQUlPLEVBQVUsQ0FBRXlGLE1BQUssRUFBRWhHLGFBQVksT0MxZjFDc0gsRUFBMkIsR0FHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQnBDLElBQWpCcUMsRUFDSCxPQUFPQSxFQUFhbEosUUFHckIsSUFBSUMsRUFBUzhJLEVBQXlCRSxHQUFZLENBR2pEakosUUFBUyxJQU9WLE9BSEFtSixFQUFvQkYsR0FBVTNILEtBQUtyQixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTZ0osR0FHcEUvSSxFQUFPRCxRLCtHQ3BCZixhQUNBLFdBQWUsYUFBSyxJQUNQLEVBQUFvSix3QkFBMEIsV0FDbkMsT0FBTyxhQUFLLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mbGFnc21pdGgvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2ZsYWdzbWl0aC8uL25vZGVfbW9kdWxlcy9mYXN0LWRlZXAtZXF1YWwvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZmxhZ3NtaXRoLy4vZmxhZ3NtaXRoLWNvcmUudHMiLCJ3ZWJwYWNrOi8vZmxhZ3NtaXRoL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2ZsYWdzbWl0aC8uL2luZGV4LnJlYWN0LW5hdGl2ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJmbGFnc21pdGhcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiZmxhZ3NtaXRoXCJdID0gZmFjdG9yeSgpO1xufSkoZ2xvYmFsLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIndXNlIHN0cmljdCc7XG5cbi8vIGRvIG5vdCBlZGl0IC5qcyBmaWxlcyBkaXJlY3RseSAtIGVkaXQgc3JjL2luZGV4LmpzdFxuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlcXVhbChhLCBiKSB7XG4gIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZTtcblxuICBpZiAoYSAmJiBiICYmIHR5cGVvZiBhID09ICdvYmplY3QnICYmIHR5cGVvZiBiID09ICdvYmplY3QnKSB7XG4gICAgaWYgKGEuY29uc3RydWN0b3IgIT09IGIuY29uc3RydWN0b3IpIHJldHVybiBmYWxzZTtcblxuICAgIHZhciBsZW5ndGgsIGksIGtleXM7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYSkpIHtcbiAgICAgIGxlbmd0aCA9IGEubGVuZ3RoO1xuICAgICAgaWYgKGxlbmd0aCAhPSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gIT09IDA7KVxuICAgICAgICBpZiAoIWVxdWFsKGFbaV0sIGJbaV0pKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cblxuXG4gICAgaWYgKGEuY29uc3RydWN0b3IgPT09IFJlZ0V4cCkgcmV0dXJuIGEuc291cmNlID09PSBiLnNvdXJjZSAmJiBhLmZsYWdzID09PSBiLmZsYWdzO1xuICAgIGlmIChhLnZhbHVlT2YgIT09IE9iamVjdC5wcm90b3R5cGUudmFsdWVPZikgcmV0dXJuIGEudmFsdWVPZigpID09PSBiLnZhbHVlT2YoKTtcbiAgICBpZiAoYS50b1N0cmluZyAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZykgcmV0dXJuIGEudG9TdHJpbmcoKSA9PT0gYi50b1N0cmluZygpO1xuXG4gICAga2V5cyA9IE9iamVjdC5rZXlzKGEpO1xuICAgIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICAgIGlmIChsZW5ndGggIT09IE9iamVjdC5rZXlzKGIpLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gIT09IDA7KVxuICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwga2V5c1tpXSkpIHJldHVybiBmYWxzZTtcblxuICAgIGZvciAoaSA9IGxlbmd0aDsgaS0tICE9PSAwOykge1xuICAgICAgdmFyIGtleSA9IGtleXNbaV07XG5cbiAgICAgIGlmICghZXF1YWwoYVtrZXldLCBiW2tleV0pKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyB0cnVlIGlmIGJvdGggTmFOLCBmYWxzZSBvdGhlcndpc2VcbiAgcmV0dXJuIGEhPT1hICYmIGIhPT1iO1xufTtcbiIsImltcG9ydCB7SUZsYWdzbWl0aH0gZnJvbSBcIi4vdHlwZXNcIjtcblxubGV0IF9mZXRjaDogdHlwZW9mIGdsb2JhbC5mZXRjaDtcbmxldCBBc3luY1N0b3JhZ2U7XG5jb25zdCBGTEFHU01JVEhfS0VZID0gXCJCVUxMRVRfVFJBSU5fREJcIjtcbmNvbnN0IEZMQUdTTUlUSF9FVkVOVCA9IFwiQlVMTEVUX1RSQUlOX0VWRU5UXCI7XG5jb25zdCBkZWZhdWx0QVBJID0gJ2h0dHBzOi8vYXBpLmZsYWdzbWl0aC5jb20vYXBpL3YxLyc7XG5jb25zdCBkZWVwRXF1YWwgPSByZXF1aXJlKCdmYXN0LWRlZXAtZXF1YWwnKTtcblxuY29uc3QgaW5pdEVycm9yID0gZnVuY3Rpb24gKGNhbGxlcikge1xuICAgIHJldHVybiBcIkF0dGVtcHRlZCB0byBcIiArIGNhbGxlciArIFwiIGEgdXNlciBiZWZvcmUgY2FsbGluZyBmbGFnc21pdGguaW5pdC4gQ2FsbCBmbGFnc21pdGguaW5pdCBmaXJzdCwgaWYgeW91IHdpc2ggdG8gcHJldmVudCBpdCBzZW5kaW5nIGEgcmVxdWVzdCBmb3IgZmxhZ3MsIGNhbGwgaW5pdCB3aXRoIHByZXZlbnRGZXRjaDp0cnVlLlwiXG59XG5cbmNvbnN0IEZsYWdzbWl0aCA9IGNsYXNzIHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIGlmIChwcm9wcy5mZXRjaCkge1xuICAgICAgICAgICAgX2ZldGNoID0gcHJvcHMuZmV0Y2g7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfZmV0Y2ggPSBnbG9iYWwuZmV0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgQXN5bmNTdG9yYWdlID0gcHJvcHMuQXN5bmNTdG9yYWdlO1xuICAgIH1cblxuICAgIGdldEpTT04gPSAodXJsOnN0cmluZywgbWV0aG9kPzpcIkdFVFwifFwiUE9TVFwifFwiUFVUXCIsIGJvZHk/OkJvZHlJbml0KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZW52aXJvbm1lbnRJRCwgaGVhZGVycyB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kIHx8ICdHRVQnLFxuICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAneC1lbnZpcm9ubWVudC1rZXknOiBlbnZpcm9ubWVudElEXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmIChtZXRob2QgJiYgbWV0aG9kICE9PSBcIkdFVFwiKVxuICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04J1xuXG4gICAgICAgIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG9wdGlvbnMuaGVhZGVycywgaGVhZGVycylcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2ZldGNoKHVybCwgb3B0aW9ucylcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy50ZXh0KClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHRleHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcnIgPSB0ZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBKU09OLnBhcnNlKHRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMub2sgPyBlcnIgOiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICB9O1xuXG4gICAgZ2V0RmxhZ3MgPSAocmVzb2x2ZT86KHY/OmFueSk9PmFueSwgcmVqZWN0Pzoodj86YW55KT0+YW55KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgb25DaGFuZ2UsIG9uRXJyb3IsIGlkZW50aXR5LCBhcGkgfSA9IHRoaXM7XG4gICAgICAgIGxldCByZXNvbHZlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCBoYW5kbGVSZXNwb25zZSA9ICh7IGZsYWdzOiBmZWF0dXJlcywgdHJhaXRzIH0sIHNlZ21lbnRzKSA9PiB7XG4gICAgICAgICAgICB0aGlzLndpdGhUcmFpdHMgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBzZXJ2ZXIgcmVzcG9uc2VcbiAgICAgICAgICAgIGxldCBmbGFncyA9IHt9O1xuICAgICAgICAgICAgbGV0IHVzZXJUcmFpdHMgPSB7fTtcbiAgICAgICAgICAgIGZlYXR1cmVzID0gZmVhdHVyZXMgfHwgW107XG4gICAgICAgICAgICB0cmFpdHMgPSB0cmFpdHMgfHwgW107XG4gICAgICAgICAgICBmZWF0dXJlcy5mb3JFYWNoKGZlYXR1cmUgPT4ge1xuICAgICAgICAgICAgICAgIGZsYWdzW2ZlYXR1cmUuZmVhdHVyZS5uYW1lLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvIC9nLCAnXycpXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGZlYXR1cmUuZmVhdHVyZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogZmVhdHVyZS5lbmFibGVkLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZmVhdHVyZS5mZWF0dXJlX3N0YXRlX3ZhbHVlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdHJhaXRzLmZvckVhY2godHJhaXQgPT4ge1xuICAgICAgICAgICAgICAgIHVzZXJUcmFpdHNbdHJhaXQudHJhaXRfa2V5LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvIC9nLCAnXycpXSA9IHRyYWl0LnRyYWl0X3ZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub2xkRmxhZ3MgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy5mbGFnc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChzZWdtZW50cykge1xuICAgICAgICAgICAgICAgIGxldCB1c2VyU2VnbWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICBzZWdtZW50cy5tYXAoKHMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlclNlZ21lbnRzW3MubmFtZV0gPSBzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VnbWVudHMgPSB1c2VyU2VnbWVudHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBmbGFnc0VxdWFsID0gZGVlcEVxdWFsKHRoaXMuZmxhZ3MsIGZsYWdzKTtcbiAgICAgICAgICAgIGNvbnN0IHRyYWl0c0VxdWFsID0gZGVlcEVxdWFsKHRoaXMudHJhaXRzLCB1c2VyVHJhaXRzKTtcbiAgICAgICAgICAgIHRoaXMuZmxhZ3MgPSBmbGFncztcbiAgICAgICAgICAgIHRoaXMudHJhaXRzID0gdXNlclRyYWl0cztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RvcmFnZSgpO1xuICAgICAgICAgICAgaWYgKG9uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgb25DaGFuZ2UodGhpcy5vbGRGbGFncywge1xuICAgICAgICAgICAgICAgICAgICBpc0Zyb21TZXJ2ZXI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzQ2hhbmdlZDogIWZsYWdzRXF1YWwsXG4gICAgICAgICAgICAgICAgICAgIHRyYWl0c0NoYW5nZWQ6ICF0cmFpdHNFcXVhbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChpZGVudGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICB0aGlzLndpdGhUcmFpdHM/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SlNPTihhcGkgKyAnaWRlbnRpdGllcy8nLCBcIlBPU1RcIiwgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZGVudGlmaWVyXCI6IGlkZW50aXR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhaXRzOiBPYmplY3Qua2V5cyh0aGlzLndpdGhUcmFpdHMpLm1hcCgoayk9Pih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmFpdF9rZXlcIjprLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHJhaXRfdmFsdWVcIjogdGhpcy53aXRoVHJhaXRzW2tdXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAgICAgfSkpOlxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0SlNPTihhcGkgKyAnaWRlbnRpdGllcy8/aWRlbnRpZmllcj0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGlkZW50aXR5KSksXG4gICAgICAgICAgICBdKVxuICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVSZXNwb25zZShyZXNbMF0sIHJlc1sxXSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc29sdmUgJiYgIXJlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoeyBtZXNzYWdlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvciAmJiBvbkVycm9yKHsgbWVzc2FnZSB9KVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgICAgICB0aGlzLmdldEpTT04oYXBpICsgXCJmbGFncy9cIilcbiAgICAgICAgICAgIF0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZVJlc3BvbnNlKHsgZmxhZ3M6IHJlc1swXSB9LCBudWxsKVxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzb2x2ZSAmJiAhcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlamVjdCAmJiAhcmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IgJiYgb25FcnJvcihlcnIpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgYW5hbHl0aWNzRmxhZ3MgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgYXBpIH0gPSB0aGlzO1xuICAgICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcy5ldmFsdWF0aW9uRXZlbnQpLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SlNPTihhcGkgKyAnYW5hbHl0aWNzL2ZsYWdzLycsICdQT1NUJywgSlNPTi5zdHJpbmdpZnkodGhpcy5ldmFsdWF0aW9uRXZlbnQpKVxuICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLmdldFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBldmFsdWF0aW9uRXZlbnQ6IHt9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFdmVudFN0b3JhZ2UoKTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKFwiRXhjZXB0aW9uIGZldGNoaW5nIGV2YWx1YXRpb25FdmVudFwiLCBlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFuYWx5dGljc0ludGVydmFsPSBudWxsXG4gICAgYXBpPSBudWxsXG4gICAgY2FjaGVGbGFncz0gbnVsbFxuICAgIGVuYWJsZUFuYWx5dGljcz0gbnVsbFxuICAgIGVuYWJsZUxvZ3M9IG51bGxcbiAgICBlbnZpcm9ubWVudElEPSBudWxsXG4gICAgZXZhbHVhdGlvbkV2ZW50PSBudWxsXG4gICAgZmxhZ3M9IG51bGxcbiAgICBnZXRGbGFnSW50ZXJ2YWw9IG51bGxcbiAgICBoZWFkZXJzPSBudWxsXG4gICAgaW5pdGlhbGlzZWQ9IG51bGxcbiAgICBvbGRGbGFncz0gbnVsbFxuICAgIG9uQ2hhbmdlPSBudWxsXG4gICAgb25FcnJvcj0gbnVsbFxuICAgIGlkZW50aXR5PSBudWxsXG4gICAgc2VnbWVudHM9IG51bGxcbiAgICB0aWNrcz0gbnVsbFxuICAgIHRpbWVyPSBudWxsXG4gICAgdHJhaXRzPSBudWxsXG4gICAgd2l0aFRyYWl0cz0gbnVsbFxuXG4gICAgaW5pdCh7XG4gICAgICAgIGVudmlyb25tZW50SUQsXG4gICAgICAgIGFwaSA9IGRlZmF1bHRBUEksXG4gICAgICAgIGhlYWRlcnMsXG4gICAgICAgIG9uQ2hhbmdlLFxuICAgICAgICBjYWNoZUZsYWdzLFxuICAgICAgICBvbkVycm9yLFxuICAgICAgICBkZWZhdWx0RmxhZ3MsXG4gICAgICAgIHByZXZlbnRGZXRjaCxcbiAgICAgICAgZW5hYmxlTG9ncyxcbiAgICAgICAgZW5hYmxlQW5hbHl0aWNzLFxuICAgICAgICBBc3luY1N0b3JhZ2U6IF9Bc3luY1N0b3JhZ2UsXG4gICAgICAgIHN0YXRlXG4gICAgfSkge1xuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVudmlyb25tZW50SUQgPSBlbnZpcm9ubWVudElEO1xuICAgICAgICAgICAgdGhpcy5hcGkgPSBhcGk7XG4gICAgICAgICAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICAgICAgdGhpcy5nZXRGbGFnSW50ZXJ2YWwgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5hbmFseXRpY3NJbnRlcnZhbCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlID0gb25DaGFuZ2U7XG4gICAgICAgICAgICB0aGlzLm9uRXJyb3IgPSBvbkVycm9yO1xuICAgICAgICAgICAgdGhpcy5lbmFibGVMb2dzID0gZW5hYmxlTG9ncztcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlQW5hbHl0aWNzID0gZW5hYmxlQW5hbHl0aWNzID8gZW5hYmxlQW5hbHl0aWNzIDogZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmZsYWdzID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEZsYWdzKSB8fCB7fTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGlzZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy50aWNrcyA9IDEwMDAwO1xuXG5cbiAgICAgICAgICAgIHRoaXMudGltZXIgPSB0aGlzLmVuYWJsZUxvZ3MgPyBuZXcgRGF0ZSgpLnZhbHVlT2YoKSA6IG51bGw7XG4gICAgICAgICAgICBpZiAoX0FzeW5jU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIEFzeW5jU3RvcmFnZSA9IF9Bc3luY1N0b3JhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNhY2hlRmxhZ3MgPSB0eXBlb2YgQXN5bmNTdG9yYWdlICE9PSAndW5kZWZpbmVkJyAmJiBjYWNoZUZsYWdzO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZSlcbiAgICAgICAgICAgIGlmICghZW52aXJvbm1lbnRJRCkge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnUGxlYXNlIHNwZWNpZnkgYSBlbnZpcm9ubWVudCBpZCcpXG4gICAgICAgICAgICAgICAgdGhyb3cgKCdQbGVhc2Ugc3BlY2lmeSBhIGVudmlyb25tZW50IGlkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEFzeW5jU3RvcmFnZS5nZXRJdGVtKEZMQUdTTUlUSF9FVkVOVClcbiAgICAgICAgICAgICAgICAudGhlbigocmVzKT0+e1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmFsdWF0aW9uRXZlbnQgPSBKU09OLnBhcnNlKHJlcylcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmFsdWF0aW9uRXZlbnQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXZhbHVhdGlvbkV2ZW50ID0ge307XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmFseXRpY3NJbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMuYW5hbHl0aWNzRmxhZ3MsIHRoaXMudGlja3MpO1xuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZUFuYWx5dGljcykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFuYWx5dGljc0ludGVydmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5hbmFseXRpY3NJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgQXN5bmNTdG9yYWdlLmdldEl0ZW0oRkxBR1NNSVRIX0VWRU5ULCAoZXJyLCByZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpzb24gPSBKU09OLnBhcnNlKHJlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKFwiUmV0cmlldmVkIGV2ZW50cyBmcm9tIGNhY2hlXCIsIHJlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmFsdWF0aW9uRXZlbnQ6IGpzb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9JZiB0aGUgdXNlciBzcGVjaWZpZWQgZGVmYXVsdCBmbGFncyBlbWl0IGEgY2hhbmdlZCBldmVudCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgaWYgKGNhY2hlRmxhZ3MpIHtcbiAgICAgICAgICAgICAgICBBc3luY1N0b3JhZ2UuZ2V0SXRlbShGTEFHU01JVEhfS0VZLCAoZXJyLCByZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbiA9IEpTT04ucGFyc2UocmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiBqc29uLmFwaSA9PT0gdGhpcy5hcGkgJiYganNvbi5lbnZpcm9ubWVudElEID09PSB0aGlzLmVudmlyb25tZW50SUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShqc29uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coXCJSZXRyaWV2ZWQgZmxhZ3MgZnJvbSBjYWNoZVwiLCBqc29uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5mbGFncykgeyAvLyByZXRyaWV2ZWQgZmxhZ3MgZnJvbSBsb2NhbCBzdG9yYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9uQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKG51bGwsIHsgaXNGcm9tU2VydmVyOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9sZEZsYWdzID0gdGhpcy5mbGFncztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmV2ZW50RmV0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RmxhZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJldmVudEZldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEZsYWdzKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKFwiRXhjZXB0aW9uIGZldGNoaW5nIGNhY2hlZCBsb2dzXCIsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmV2ZW50RmV0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEZsYWdzKHJlc29sdmUsIHJlamVjdClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRGbGFncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKG51bGwsIHsgaXNGcm9tU2VydmVyOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghcHJldmVudEZldGNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRGbGFncyhyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdEZsYWdzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2UobnVsbCwgeyBpc0Zyb21TZXJ2ZXI6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4gb25FcnJvciAmJiBvbkVycm9yKGVycm9yKSk7XG4gICAgfVxuXG4gICAgZ2V0QWxsRmxhZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZsYWdzO1xuICAgIH1cblxuICAgIGlkZW50aWZ5KHVzZXJJZCwgdHJhaXRzKSB7XG4gICAgICAgIHRoaXMuaWRlbnRpdHkgPSB1c2VySWQ7XG4gICAgICAgIGlmKHRyYWl0cykge1xuICAgICAgICAgICAgdGhpcy53aXRoVHJhaXRzID0gdHJhaXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluaXRpYWxpc2VkICYmICF0aGlzLmdldEZsYWdJbnRlcnZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmxhZ3MoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuXG4gICAgZ2V0U3RhdGUoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhcGk6IHRoaXMuYXBpLFxuICAgICAgICAgICAgZW52aXJvbm1lbnRJRDogdGhpcy5lbnZpcm9ubWVudElELFxuICAgICAgICAgICAgZmxhZ3M6IHRoaXMuZmxhZ3MsXG4gICAgICAgICAgICBpZGVudGl0eTogdGhpcy5pZGVudGl0eSxcbiAgICAgICAgICAgIHNlZ21lbnRzOiB0aGlzLnNlZ21lbnRzLFxuICAgICAgICAgICAgdHJhaXRzOiB0aGlzLnRyYWl0cyxcbiAgICAgICAgICAgIGV2YWx1YXRpb25FdmVudDogdGhpcy5ldmFsdWF0aW9uRXZlbnQsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRTdGF0ZShzdGF0ZSkge1xuICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGlzZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5hcGkgPSBzdGF0ZS5hcGkgfHwgdGhpcy5hcGkgfHwgZGVmYXVsdEFQSTtcbiAgICAgICAgICAgIHRoaXMuZW52aXJvbm1lbnRJRCA9IHN0YXRlLmVudmlyb25tZW50SUQgfHwgdGhpcy5lbnZpcm9ubWVudElEO1xuICAgICAgICAgICAgdGhpcy5mbGFncyA9IHN0YXRlLmZsYWdzIHx8IHRoaXMuZmxhZ3M7XG4gICAgICAgICAgICB0aGlzLmlkZW50aXR5ID0gc3RhdGUuaWRlbnRpdHkgfHwgdGhpcy5pZGVudGl0eTtcbiAgICAgICAgICAgIHRoaXMuc2VnbWVudHMgPSBzdGF0ZS5zZWdtZW50cyB8fCB0aGlzLnNlZ21lbnRzO1xuICAgICAgICAgICAgdGhpcy50cmFpdHMgPSBzdGF0ZS50cmFpdHMgfHwgdGhpcy50cmFpdHM7XG4gICAgICAgICAgICB0aGlzLmV2YWx1YXRpb25FdmVudCA9IHN0YXRlLmV2YWx1YXRpb25FdmVudCB8fCB0aGlzLmV2YWx1YXRpb25FdmVudDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxvZyguLi5hcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUxvZ3MpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KHRoaXMsIFtcIkZMQUdTTUlUSDpcIiwgbmV3IERhdGUoKS52YWx1ZU9mKCkgLSB0aGlzLnRpbWVyLCBcIm1zXCIsIC4uLmFyZ3NdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZVN0b3JhZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmNhY2hlRmxhZ3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gSlNPTi5zdHJpbmdpZnkodGhpcy5nZXRTdGF0ZSgpKTtcbiAgICAgICAgICAgIHRoaXMubG9nKFwiU2V0dGluZyBzdG9yYWdlXCIsIHN0YXRlKTtcbiAgICAgICAgICAgIEFzeW5jU3RvcmFnZS5zZXRJdGVtKEZMQUdTTUlUSF9LRVksIHN0YXRlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZUV2ZW50U3RvcmFnZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlQW5hbHl0aWNzKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudHMgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmdldFN0YXRlKCkuZXZhbHVhdGlvbkV2ZW50KTtcbiAgICAgICAgICAgIHRoaXMubG9nKFwiU2V0dGluZyBldmVudCBzdG9yYWdlXCIsIGV2ZW50cyk7XG4gICAgICAgICAgICBBc3luY1N0b3JhZ2Uuc2V0SXRlbShGTEFHU01JVEhfRVZFTlQsIGV2ZW50cyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsb2dvdXQoKSB7XG4gICAgICAgIHRoaXMuaWRlbnRpdHkgPSBudWxsO1xuICAgICAgICB0aGlzLnNlZ21lbnRzID0gbnVsbDtcbiAgICAgICAgdGhpcy50cmFpdHMgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5pbml0aWFsaXNlZCAmJiAhdGhpcy5nZXRGbGFnSW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZsYWdzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cblxuICAgIHN0YXJ0TGlzdGVuaW5nKHRpY2tzID0gMTAwMCkge1xuICAgICAgICBpZiAodGhpcy5nZXRGbGFnSW50ZXJ2YWwpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5nZXRGbGFnSW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2V0RmxhZ0ludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5nZXRGbGFncywgdGlja3MpO1xuICAgIH1cblxuICAgIHN0b3BMaXN0ZW5pbmcoKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5nZXRGbGFnSW50ZXJ2YWwpO1xuICAgICAgICB0aGlzLmdldEZsYWdJbnRlcnZhbCA9IG51bGw7XG4gICAgfVxuXG4gICAgZ2V0U2VnbWVudHMoKSB7XG4gICAgICAgIC8vIG5vb3AgZm9yIG5vd1xuICAgICAgICAvLyByZXR1cm4gdGhpcy5zZWdtZW50cztcbiAgICB9XG5cbiAgICBldmFsdWF0ZUZsYWcgPSAoa2V5KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZUFuYWx5dGljcykge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmV2YWx1YXRpb25FdmVudCkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKHRoaXMuZXZhbHVhdGlvbkV2ZW50W2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZXZhbHVhdGlvbkV2ZW50W2tleV0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5ldmFsdWF0aW9uRXZlbnRba2V5XSArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlRXZlbnRTdG9yYWdlKCk7XG4gICAgfVxuXG4gICAgZ2V0VmFsdWUgPSAoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IGZsYWcgPSB0aGlzLmZsYWdzICYmIHRoaXMuZmxhZ3Nba2V5LnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvIC9nLCAnXycpXTtcbiAgICAgICAgbGV0IHJlcyA9IG51bGw7XG4gICAgICAgIGlmIChmbGFnKSB7XG4gICAgICAgICAgICByZXMgPSBmbGFnLnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXZhbHVhdGVGbGFnKGtleSk7XG5cbiAgICAgICAgLy90b2RvIHJlY29yZCBjaGVjayBmb3IgdmFsdWVcblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIGdldFRyYWl0ID0gKGtleSkgPT4ge1xuICAgICAgICBjb25zdCB0cmFpdCA9IHRoaXMudHJhaXRzICYmIHRoaXMudHJhaXRzW2tleS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoLyAvZywgJ18nKV07XG4gICAgICAgIHJldHVybiB0cmFpdDtcbiAgICB9XG5cbiAgICBzZXRUcmFpdCA9IChrZXksIHRyYWl0X3ZhbHVlKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZ2V0SlNPTiwgaWRlbnRpdHksIGFwaSB9ID0gdGhpcztcblxuICAgICAgICBpZiAoIWFwaSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihpbml0RXJyb3IoXCJzZXRUcmFpdFwiKSlcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYm9keSA9IHtcbiAgICAgICAgICAgIFwiaWRlbnRpdHlcIjoge1xuICAgICAgICAgICAgICAgIFwiaWRlbnRpZmllclwiOiBpZGVudGl0eVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwidHJhaXRfa2V5XCI6IGtleSxcbiAgICAgICAgICAgIFwidHJhaXRfdmFsdWVcIjogdHJhaXRfdmFsdWVcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBnZXRKU09OKGAke2FwaX10cmFpdHMvYCwgJ1BPU1QnLCBKU09OLnN0cmluZ2lmeShib2R5KSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsaXNlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEZsYWdzKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgIH07XG5cbiAgICBzZXRUcmFpdHMgPSAodHJhaXRzKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZ2V0SlNPTiwgaWRlbnRpdHksIGFwaSB9ID0gdGhpcztcblxuICAgICAgICBpZiAoIWFwaSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihpbml0RXJyb3IoXCJzZXRUcmFpdHNcIikpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdHJhaXRzIHx8IHR5cGVvZiB0cmFpdHMgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXhwZWN0ZWQgb2JqZWN0IGZvciBmbGFnc21pdGguc2V0VHJhaXRzXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYm9keSA9IE9iamVjdC5rZXlzKHRyYWl0cykubWFwKChrZXkpID0+IChcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcImlkZW50aXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJpZGVudGlmaWVyXCI6IGlkZW50aXR5XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcInRyYWl0X2tleVwiOiBrZXksXG4gICAgICAgICAgICAgICAgXCJ0cmFpdF92YWx1ZVwiOiB0cmFpdHNba2V5XVxuICAgICAgICAgICAgfVxuICAgICAgICApKVxuXG4gICAgICAgIHJldHVybiBnZXRKU09OKGAke2FwaX10cmFpdHMvYnVsay9gLCAnUFVUJywgSlNPTi5zdHJpbmdpZnkoYm9keSkpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbGlzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRGbGFncygpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICB9O1xuXG4gICAgaW5jcmVtZW50VHJhaXQgPSAodHJhaXRfa2V5LCBpbmNyZW1lbnRfYnkpID0+IHtcbiAgICAgICAgY29uc3QgeyBnZXRKU09OLCBpZGVudGl0eSwgYXBpIH0gPSB0aGlzO1xuICAgICAgICByZXR1cm4gZ2V0SlNPTihgJHthcGl9dHJhaXRzL2luY3JlbWVudC12YWx1ZS9gLCAnUE9TVCcsIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIHRyYWl0X2tleSxcbiAgICAgICAgICAgIGluY3JlbWVudF9ieSxcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IGlkZW50aXR5XG4gICAgICAgIH0pKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgLnRoZW4odGhpcy5nZXRGbGFncylcbiAgICB9O1xuXG4gICAgaGFzRmVhdHVyZSA9IChrZXkpID0+IHtcbiAgICAgICAgY29uc3QgZmxhZyA9IHRoaXMuZmxhZ3MgJiYgdGhpcy5mbGFnc1trZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC8gL2csICdfJyldO1xuICAgICAgICBsZXQgcmVzID0gZmFsc2U7XG4gICAgICAgIGlmIChmbGFnICYmIGZsYWcuZW5hYmxlZCkge1xuICAgICAgICAgICAgcmVzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV2YWx1YXRlRmxhZyhrZXkpO1xuXG4gICAgICAgIC8vdG9kbyByZWNvcmQgY2hlY2sgZm9yIGZlYXR1cmVcblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxufTtcblxudHlwZSBDb25maWc9IHtmZXRjaD86YW55LCBBc3luY1N0b3JhZ2U/OmFueX07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICh7IGZldGNoLCBBc3luY1N0b3JhZ2UgfTpDb25maWcpOklGbGFnc21pdGgge1xuICAgIHJldHVybiBuZXcgRmxhZ3NtaXRoKHsgZmV0Y2gsIEFzeW5jU3RvcmFnZSB9KSBhcyBJRmxhZ3NtaXRoO1xufTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJcbmltcG9ydCBjb3JlICBmcm9tICcuL2ZsYWdzbWl0aC1jb3JlJ1xuZXhwb3J0IGRlZmF1bHQgY29yZSh7fSk7XG5leHBvcnQgY29uc3QgY3JlYXRlRmxhZ3NtaXRoSW5zdGFuY2UgPSAoKT0+e1xuICAgIHJldHVybiBjb3JlKHt9KVxufVxuIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImdsb2JhbCIsImVxdWFsIiwiYSIsImIiLCJjb25zdHJ1Y3RvciIsImxlbmd0aCIsImkiLCJrZXlzIiwiQXJyYXkiLCJpc0FycmF5IiwiUmVnRXhwIiwic291cmNlIiwiZmxhZ3MiLCJ2YWx1ZU9mIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJrZXkiLCJfZmV0Y2giLCJBc3luY1N0b3JhZ2UiLCJGTEFHU01JVEhfS0VZIiwiRkxBR1NNSVRIX0VWRU5UIiwiZGVmYXVsdEFQSSIsImRlZXBFcXVhbCIsImluaXRFcnJvciIsImNhbGxlciIsIkZsYWdzbWl0aCIsInByb3BzIiwiZ2V0SlNPTiIsInVybCIsIm1ldGhvZCIsImJvZHkiLCJlbnZpcm9ubWVudElEIiwiaGVhZGVycyIsIm9wdGlvbnMiLCJhc3NpZ24iLCJ0aGVuIiwicmVzIiwidGV4dCIsImVyciIsIkpTT04iLCJwYXJzZSIsImUiLCJvayIsIlByb21pc2UiLCJyZWplY3QiLCJnZXRGbGFncyIsInJlc29sdmUiLCJvbkNoYW5nZSIsIm9uRXJyb3IiLCJpZGVudGl0eSIsImFwaSIsInJlc29sdmVkIiwiaGFuZGxlUmVzcG9uc2UiLCJzZWdtZW50cyIsImZlYXR1cmVzIiwidHJhaXRzIiwid2l0aFRyYWl0cyIsInVzZXJUcmFpdHMiLCJmb3JFYWNoIiwiZmVhdHVyZSIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJpZCIsImVuYWJsZWQiLCJ2YWx1ZSIsImZlYXR1cmVfc3RhdGVfdmFsdWUiLCJ0cmFpdCIsInRyYWl0X2tleSIsInRyYWl0X3ZhbHVlIiwib2xkRmxhZ3MiLCJtYXAiLCJzIiwiZmxhZ3NFcXVhbCIsInRyYWl0c0VxdWFsIiwidXBkYXRlU3RvcmFnZSIsImlzRnJvbVNlcnZlciIsImZsYWdzQ2hhbmdlZCIsInRyYWl0c0NoYW5nZWQiLCJhbGwiLCJzdHJpbmdpZnkiLCJrIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiY2F0Y2giLCJtZXNzYWdlIiwiYW5hbHl0aWNzRmxhZ3MiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiZXZhbHVhdGlvbkV2ZW50Iiwic3RhdGUiLCJnZXRTdGF0ZSIsInNldFN0YXRlIiwidXBkYXRlRXZlbnRTdG9yYWdlIiwibG9nIiwiYW5hbHl0aWNzSW50ZXJ2YWwiLCJjYWNoZUZsYWdzIiwiZW5hYmxlQW5hbHl0aWNzIiwiZW5hYmxlTG9ncyIsImdldEZsYWdJbnRlcnZhbCIsImluaXRpYWxpc2VkIiwidGlja3MiLCJ0aW1lciIsImV2YWx1YXRlRmxhZyIsInVuZGVmaW5lZCIsImdldFZhbHVlIiwiZmxhZyIsImdldFRyYWl0Iiwic2V0VHJhaXQiLCJjb25zb2xlIiwiZXJyb3IiLCJzZXRUcmFpdHMiLCJpbmNyZW1lbnRUcmFpdCIsImluY3JlbWVudF9ieSIsImlkZW50aWZpZXIiLCJoYXNGZWF0dXJlIiwiZmV0Y2giLCJpbml0IiwiZGVmYXVsdEZsYWdzIiwicHJldmVudEZldGNoIiwiX0FzeW5jU3RvcmFnZSIsIkRhdGUiLCJnZXRJdGVtIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwianNvbiIsImdldEFsbEZsYWdzIiwidGhpcyIsImlkZW50aWZ5IiwidXNlcklkIiwiYXBwbHkiLCJhcmdzIiwic2V0SXRlbSIsImV2ZW50cyIsImxvZ291dCIsInN0YXJ0TGlzdGVuaW5nIiwic3RvcExpc3RlbmluZyIsImdldFNlZ21lbnRzIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNyZWF0ZUZsYWdzbWl0aEluc3RhbmNlIl0sInNvdXJjZVJvb3QiOiIifQ==