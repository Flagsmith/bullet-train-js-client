!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["react-native-flagsmith/react"]={},t.React)}(this,(function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(e),i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)},o={exports:{}};function a(){}a.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function i(){r.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,a=r.length;o<a;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},o.exports=a,o.exports.TinyEmitter=a;var u=new o.exports.TinyEmitter,s=e.createContext(null),f=function(t){var n=e.useRef(t);return n.current||(n.current=t),n.current},c=function(t){if("string"==typeof t)return[t];if("object"==typeof t&&t.hasOwnProperty("length"))return t;throw new Error("Flagsmith: please supply an array of strings or a single string of flag keys to useFlags")},l=function(t,e,n){return void 0===n&&(n=[]),e.map((function(e){return"".concat(t.getValue(e)).concat(t.hasFeature(e))})).concat(n.map((function(e){return"".concat(t.getTrait(e))}))).join(",")};t.FlagsmithContext=s,t.FlagsmithProvider=function(t){var n=t.flagsmith,o=t.options,a=t.serverState,f=t.children,c=e.useRef(!0);return n&&!(null==n?void 0:n._trigger)&&(n._trigger=function(){n.log("React - trigger event received"),u.emit("event")}),n&&!(null==n?void 0:n._triggerLoadingState)&&(n._triggerLoadingState=function(){u.emit("loading_event")}),a&&!n.initialised&&n.setState(a),c.current&&(c.current=!1,o&&n.init(i(i({},o),{state:o.state||a,onChange:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];o.onChange&&o.onChange.apply(o,t)}}))),r.default.createElement(s.Provider,{value:n},f)},t.useFlags=function(t,n){void 0===n&&(n=[]);var r=e.useRef(!0),i=f(c(t)),o=f(c(n)),a=e.useContext(s),g=e.useState(l(a,i,o)),h=g[0],v=g[1],p=e.useCallback((function(){var t=l(a,i,o);t!==h&&(null==a||a.log("React - useFlags flags and traits have changed"),v(t))}),[h]);return r.current&&(r.current=!1,null==a||a.log("React - Initialising event listeners")),e.useEffect((function(){return u.on("event",p),function(){u.off("event",p)}}),[p]),e.useMemo((function(){var t={};return i.map((function(e){t[e]={enabled:a.hasFeature(e),value:a.getValue(e)}})).concat(null==o?void 0:o.map((function(e){t[e]=a.getTrait(e)}))),t}),[h])},t.useFlagsmith=function(){var t=e.useContext(s);if(!t)throw new Error("useFlagsmith must be used with in a FlagsmithProvider");return t},t.useFlagsmithLoading=function(){var t=e.useContext(s),n=e.useState(null==t?void 0:t.loadingState),r=n[0],i=n[1],o=e.useCallback((function(){i(null==t?void 0:t.loadingState)}),[t]);return e.useEffect((function(){return u.on("event",o),function(){u.off("event",o)}}),[o]),r},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=react.js.map
